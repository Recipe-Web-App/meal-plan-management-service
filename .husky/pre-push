#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "ğŸš€ Running pre-push checks..."

# Run full build
echo "ğŸ”¨ Running build..."
npm run build
if [ $? -ne 0 ]; then
  echo "âŒ Build failed! Please fix build errors before pushing."
  exit 1
fi

# Run all tests with coverage
echo "ğŸ§ª Running all tests with coverage..."
npm run test:cov
if [ $? -ne 0 ]; then
  echo "âŒ Tests failed or coverage requirements not met!"
  echo "ğŸ“Š Coverage must be at least 65% for branches, functions, lines, and statements."
  exit 1
fi

echo "âœ… All pre-push checks passed!"