name: Validate Dependabot Configuration

on:
  push:
    paths:
      - '.github/dependabot.yml'
  pull_request:
    paths:
      - '.github/dependabot.yml'

jobs:
  validate-dependabot:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Validate Dependabot configuration
        run: |
          echo "✅ Dependabot configuration file exists"
          if [ -f ".github/dependabot.yml" ]; then
            echo "✅ Dependabot configuration found at .github/dependabot.yml"
            # Basic YAML syntax validation
            python -c "import yaml; yaml.safe_load(open('.github/dependabot.yml'))" && echo "✅ YAML syntax is valid"
          else
            echo "❌ Dependabot configuration not found"
            exit 1
          fi

      - name: Check configuration completeness
        run: |
          if grep -q "package-ecosystem.*npm" .github/dependabot.yml; then
            echo "✅ npm ecosystem configured"
          else
            echo "⚠️ npm ecosystem not found"
          fi

          if grep -q "package-ecosystem.*docker" .github/dependabot.yml; then
            echo "✅ Docker ecosystem configured"
          else
            echo "⚠️ Docker ecosystem not found"
          fi

          if grep -q "package-ecosystem.*github-actions" .github/dependabot.yml; then
            echo "✅ GitHub Actions ecosystem configured"
          else
            echo "⚠️ GitHub Actions ecosystem not found"
          fi

      - name: Summary
        run: |
          echo "🎉 Dependabot configuration validation completed!"
          echo "Dependabot will now automatically:"
          echo "  📦 Monitor npm dependencies daily"
          echo "  🐳 Monitor Docker dependencies weekly"
          echo "  🔄 Monitor GitHub Actions dependencies weekly"
          echo "  🏷️ Group related dependencies"
          echo "  📝 Create well-labeled pull requests"
