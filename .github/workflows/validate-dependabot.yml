name: Validate Dependabot Configuration

on:
  push:
    paths:
      - '.github/dependabot.yml'
  pull_request:
    paths:
      - '.github/dependabot.yml'

jobs:
  validate-dependabot:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v6

      - name: Validate Dependabot configuration
        run: |
          echo "âœ… Dependabot configuration file exists"
          if [ -f ".github/dependabot.yml" ]; then
            echo "âœ… Dependabot configuration found at .github/dependabot.yml"
            # Basic YAML syntax validation
            python -c "import yaml; yaml.safe_load(open('.github/dependabot.yml'))" && echo "âœ… YAML syntax is valid"
          else
            echo "âŒ Dependabot configuration not found"
            exit 1
          fi

      - name: Check configuration completeness
        run: |
          if grep -q "package-ecosystem.*npm" .github/dependabot.yml; then
            echo "âœ… npm ecosystem configured"
          else
            echo "âš ï¸ npm ecosystem not found"
          fi

          if grep -q "package-ecosystem.*docker" .github/dependabot.yml; then
            echo "âœ… Docker ecosystem configured"
          else
            echo "âš ï¸ Docker ecosystem not found"
          fi

          if grep -q "package-ecosystem.*github-actions" .github/dependabot.yml; then
            echo "âœ… GitHub Actions ecosystem configured"
          else
            echo "âš ï¸ GitHub Actions ecosystem not found"
          fi

      - name: Summary
        run: |
          echo "ğŸ‰ Dependabot configuration validation completed!"
          echo "Dependabot will now automatically:"
          echo "  ğŸ“¦ Monitor npm dependencies daily"
          echo "  ğŸ³ Monitor Docker dependencies weekly"
          echo "  ğŸ”„ Monitor GitHub Actions dependencies weekly"
          echo "  ğŸ·ï¸ Group related dependencies"
          echo "  ğŸ“ Create well-labeled pull requests"
